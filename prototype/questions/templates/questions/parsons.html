{% extends "questions/base.html" %}

{% block content %}
<b>{{question.title}}</b>
<p>
    <pre>{{question.question_text|linebreaks}}</pre>
</p>

<p>Construct your program by dragging and dropping lines from the left to the solution area on the right.</p>
<div id="jsparsons-source" class="sortable-code"></div>
<div id="jsparsons-target" class="sortable-code"></div>
<div style="clear:both;"></div>
<br>
<p>
    <a href="#" id="newInstanceLink">Reset</a>
    <a href="#" id="feedbackLink">Submit</a>
</p>

{% endblock %}

{% block javascript %}

<script>
    var initial = "{{question.solution|escapejs}}";

    function displayErrors(fb) {
        if (fb.errors.length > 0) {
            alert(fb.errors[0]);
        }  
    }

    $(document).ready(function(){
        var parson = new ParsonsWidget({
            sortableId: 'jsparsons-target',
            trashId: 'jsparsons-source',
            max_wrong_lines: 1,
            feedback_cb : displayErrors,
            can_indent: true
        });

        parson.init(initial);
        parson.shuffleLines();
        
        $("#newInstanceLink").click(function(event){
            event.preventDefault();
            parson.shuffleLines();
        });
        $("#feedbackLink").click(function(event){
            event.preventDefault();
            parson.getFeedback();
        });
    });
</script>
{% endblock %}